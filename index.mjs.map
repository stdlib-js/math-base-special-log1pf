{"version":3,"file":"index.mjs","sources":["../lib/main.js","../lib/polyval_lp.js"],"sourcesContent":["/**\n* @license Apache-2.0\n*\n* Copyright (c) 2025 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*\n*\n* ## Notice\n*\n* The following copyright, license, and long comment were part of the original implementation available as part of [FreeBSD]{@link https://svnweb.freebsd.org/base/release/12.2.0/lib/msun/src/s_log1pf.c}. The implementation follows the original, but has been modified for JavaScript.\n*\n* ```text\n* Copyright (C) 1993 by Sun Microsystems, Inc. All rights reserved.\n*\n* Developed at SunPro, a Sun Microsystems, Inc. business.\n* Permission to use, copy, modify, and distribute this\n* software is freely granted, provided that this notice\n* is preserved.\n* ```\n*/\n\n'use strict';\n\n// MODULES //\n\nimport FLOAT32_NINF from '@stdlib/constants-float32-ninf';\nimport FLOAT32_ABS_MASK from '@stdlib/constants-float32-abs-mask';\nimport FLOAT32_PRECISION from '@stdlib/constants-float32-precision';\nimport FLOAT32_EXPONENT_BIAS from '@stdlib/constants-float32-exponent-bias';\nimport FLOAT32_EXPONENT_MASK from '@stdlib/constants-float32-exponent-mask';\nimport FLOAT32_SIGNIFICAND_MASK from '@stdlib/constants-float32-significand-mask';\nimport toWordf from '@stdlib/number-float32-base-to-word';\nimport fromWordf from '@stdlib/number-float32-base-from-word';\nimport f32 from '@stdlib/number-float64-base-to-float32';\nimport polyval from './polyval_lp.js';\n\n\n// VARIABLES //\n\n// High and low words of ln(2):\nvar LN2_HI = f32( 6.9313812256e-01 ); // 0x3f317180\nvar LN2_LO = f32( 9.0580006145e-06 ); // 0x3717f7d1\n\n// 2**25:\nvar TWO25 = f32( 3.355443200e+07 ); // 0x4c000000\n\n// 2/3:\nvar TWO_THIRDS = f32( 0.66666666666666666 );\n\n// 2**53 = 9007199254740992 => 0 10110100 00000000000000000000000 => 0x5a000000 = 1509949440\nvar TWO53 = 0x5a000000|0; // asm type annotation\n\n// 2**-15 = 0.000030517578125 => 0 01110000 00000000000000000000000 => 0x38000000 = 939524096\nvar TWO_NEG_15 = 0x38000000|0; // asm type annotation\n\n// 2**-24 = 5.960464477539063e-8 => 0 01100111 00000000000000000000000 => 0x33800000 = 864026624\nvar TWO_NEG_24 = 0x33800000|0; // asm type annotation\n\n// 1 => 0 01111111 00000000000000000000000 => 0x3f800000 = 1065353216\nvar ONE_WORD = 0x3f800000|0; // asm type annotation\n\n// 1/2 = 0.5 => 0 01111110 00000000000000000000000 => 0x3f000000 = 1056964608\nvar HALF_WORD = 0x3f000000|0; // asm type annotation\n\n// sqrt(2)-1 = 0.41421353816986084 => 0 01111101 10101000001001111010000 => 0x3ed413d0 = 1054086096\nvar SQRT2M1 = 0x3ed413d0|0; // asm type annotation\n\n// sqrt(2)/2-1 = -0.2928932309150696 => 1 01111101 00101011111011000011001 => 0xbe95f619 = 3197498905\nvar SQRT2HALFM1 = 0xbe95f619|0; // asm type annotation\n\n// 2**-126 = 1.1754943508222875e-38 => 0 00000001 00000000000000000000000 => 0x00800000 = 8388608\nvar TINY = 0x00800000|0; // asm type annotation\n\nvar NEG_ONE = f32( -1.0 );\nvar ZERO = f32( 0.0 );\nvar HALF = f32( 0.5 );\nvar ONE = f32( 1.0 );\nvar TWO = f32( 2.0 );\n\n\n// MAIN //\n\n/**\n* Evaluates the natural logarithm of \\\\(1+x\\\\) as a single-precision floating-point number.\n*\n* @param {number} x - input value\n* @returns {number} the natural logarithm of `1+x`\n*\n* @example\n* var v = log1pf( 4.0 );\n* // returns ~1.609\n*\n* @example\n* var v = log1pf( -1.0 );\n* // returns -Infinity\n*\n* @example\n* var v = log1pf( 0.0 );\n* // returns 0.0\n*\n* @example\n* var v = log1pf( -0.0 );\n* // returns -0.0\n*\n* @example\n* var v = log1pf( -2.0 );\n* // returns NaN\n*\n* @example\n* var v = log1pf( NaN );\n* // returns NaN\n*/\nfunction log1pf( x ) {\n\tvar hfsq;\n\tvar hx;\n\tvar ax;\n\tvar hu;\n\tvar f;\n\tvar c;\n\tvar s;\n\tvar z;\n\tvar R;\n\tvar u;\n\tvar k;\n\n\tx = f32( x );\n\thx = toWordf( x ) | 0; // asm type annotation\n\tax = (hx & FLOAT32_ABS_MASK)|0; // asm type annotation\n\n\tk = 1;\n\tif ( hx < SQRT2M1 ) { // 1+x < sqrt(2)+\n\t\tif ( ax >= ONE_WORD ) { // x <= -1.0\n\t\t\tif ( x === NEG_ONE ) {\n\t\t\t\treturn FLOAT32_NINF;\n\t\t\t}\n\t\t\treturn NaN;\n\t\t}\n\t\tif ( ax < TWO_NEG_15 ) { // |x| < 2**-15\n\t\t\tif ( ( f32( TWO25 + x ) > ZERO ) && ax < TWO_NEG_24 ) { // |x| < 2**-24\n\t\t\t\treturn x;\n\t\t\t}\n\t\t\treturn f32( x - f32( x * f32( x * HALF ) ) );\n\t\t}\n\t\tif ( ( hx > 0 ) || ( hx <= SQRT2HALFM1 ) ) { // sqrt(2)/2- <= 1+x < sqrt(2)+\n\t\t\tk = 0;\n\t\t\tf = x;\n\t\t\thu = 1;\n\t\t}\n\t}\n\tif ( hx >= FLOAT32_EXPONENT_MASK ) {\n\t\treturn f32( x + x );\n\t}\n\tif ( k !== 0 ) {\n\t\tif ( hx < TWO53 ) {\n\t\t\tu = f32( ONE + x );\n\t\t\thu = toWordf( u ) | 0; // asm type annotation\n\t\t\tk = ( hu >> ( FLOAT32_PRECISION - 1 ) ) - FLOAT32_EXPONENT_BIAS;\n\n\t\t\t// Correction term:\n\t\t\tc = ( k > 0 ) ? f32( ONE - f32( u-x ) ) : f32( x - f32( u-ONE ) );\n\t\t\tc = f32( c / u );\n\t\t} else {\n\t\t\tu = x;\n\t\t\thu = toWordf( u ) | 0;\n\t\t\tk = ( hu >> ( FLOAT32_PRECISION - 1 ) ) - FLOAT32_EXPONENT_BIAS;\n\t\t\tc = 0;\n\t\t}\n\t\thu &= FLOAT32_SIGNIFICAND_MASK;\n\n\t\t// Earlier sqrt(2) checks should be slightly looser than this one, so we never reach this point with k == 0 after deciding to use the correction term...\n\t\tif ( hu < 0x3504f4 ) { // u < sqrt(2)\n\t\t\tu = fromWordf( hu | ONE_WORD ); // normalize u\n\t\t} else {\n\t\t\tk += 1;\n\t\t\tu = fromWordf( hu | HALF_WORD ); // normalize u/2\n\t\t\thu = ( TINY - hu ) >> 2;\n\t\t}\n\t\tf = f32( u - ONE );\n\t}\n\thfsq = f32( HALF * f32( f * f ) );\n\tif ( hu === 0 ) { // |f| < 2**-20\n\t\tif ( f === ZERO ) {\n\t\t\tif ( k === 0 ) {\n\t\t\t\treturn ZERO;\n\t\t\t}\n\t\t\tc = f32( c + f32( k * LN2_LO ) );\n\t\t\treturn f32( f32( k * LN2_HI ) + c );\n\t\t}\n\t\tR = f32( hfsq * f32( ONE - f32( TWO_THIRDS * f ) ) );\n\t\tif ( k === 0 ) {\n\t\t\treturn f32( f - R );\n\t\t}\n\t\t// eslint-disable-next-line max-len\n\t\treturn f32( f32( k*LN2_HI ) - f32( f32( R - f32( f32( k*LN2_LO ) + c ) ) - f ) );\n\t}\n\ts = f32( f / f32( TWO + f ) );\n\tz = f32( s * s );\n\tR = f32( z * polyval( z ) );\n\tif ( k === 0 ) {\n\t\treturn f32( f - f32( hfsq - f32( s * f32( hfsq + R ) ) ) );\n\t}\n\t// eslint-disable-next-line max-len\n\treturn f32( f32( k*LN2_HI ) - f32( f32( hfsq - f32( f32( s * f32( hfsq+R ) ) + f32( f32( k*LN2_LO ) + c ) ) ) - f ) );\n}\n\n\n// EXPORTS //\n\nexport default log1pf;\n","/**\n* @license Apache-2.0\n*\n* Copyright (c) 2025 The Stdlib Authors.\n*\n* Licensed under the Apache License, Version 2.0 (the \"License\");\n* you may not use this file except in compliance with the License.\n* You may obtain a copy of the License at\n*\n*    http://www.apache.org/licenses/LICENSE-2.0\n*\n* Unless required by applicable law or agreed to in writing, software\n* distributed under the License is distributed on an \"AS IS\" BASIS,\n* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n* See the License for the specific language governing permissions and\n* limitations under the License.\n*/\n\n/* This is a generated file. Do not edit directly. */\n'use strict';\n\n// MODULES //\n\nimport float64ToFloat32 from '@stdlib/number-float64-base-to-float32';\n\n\n// MAIN //\n\n/**\n* Evaluates a polynomial.\n*\n* ## Notes\n*\n* -   The implementation uses [Horner's rule][horners-method] for efficient computation.\n*\n* [horners-method]: https://en.wikipedia.org/wiki/Horner%27s_method\n*\n* @private\n* @param {number} x - value at which to evaluate the polynomial\n* @returns {number} evaluated polynomial\n*/\nfunction evalpoly( x ) {\n\tif ( x === 0.0 ) {\n\t\treturn 0.6666666865348816;\n\t}\n\treturn float64ToFloat32(0.6666666865348816 + float64ToFloat32(x * float64ToFloat32(0.4000000059604645 + float64ToFloat32(x * float64ToFloat32(0.2857142984867096 + float64ToFloat32(x * float64ToFloat32(0.2222219854593277 + float64ToFloat32(x * float64ToFloat32(0.18183572590351105 + float64ToFloat32(x * float64ToFloat32(0.15313838422298431 + float64ToFloat32(x * 0.14798198640346527)))))))))))); // eslint-disable-line max-len\n}\n\n\n// EXPORTS //\n\nexport default evalpoly;\n"],"names":["LN2_HI","f32","LN2_LO","TWO25","TWO_THIRDS","ONE_WORD","NEG_ONE","ZERO","HALF","ONE","TWO","log1pf","x","hfsq","hx","ax","hu","f","c","s","z","R","u","k","toWordf","FLOAT32_ABS_MASK","FLOAT32_NINF","NaN","FLOAT32_EXPONENT_MASK","FLOAT32_PRECISION","FLOAT32_EXPONENT_BIAS","FLOAT32_SIGNIFICAND_MASK","fromWordf","float64ToFloat32","polyval"],"mappings":";;o6BAmDA,IAAIA,EAASC,EAAK,cACdC,EAASD,EAAK,iBAGdE,EAAQF,EAAK,UAGbG,EAAaH,EAAK,mBAYlBI,EAAW,WAcXC,EAAUL,GAAM,GAChBM,EAAON,EAAK,GACZO,EAAOP,EAAK,IACZQ,EAAMR,EAAK,GACXS,EAAMT,EAAK,GAmCf,SAASU,EAAQC,GAChB,IAAIC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAOJ,GALAX,EAAIX,EAAKW,GAETG,GADAD,EAAoB,EAAfU,EAASZ,IACHa,EAAkB,EAE7BF,EAAI,EACCT,EAjEQ,WAiEO,CACnB,GAAKC,GAAMV,EACV,OAAKO,IAAMN,EACHoB,EAEDC,IAER,GAAKZ,EApFU,UAqFd,OAAOd,EAAKE,EAAQS,GAAML,GAAUQ,EAlFtB,UAmFNH,EAEDX,EAAKW,EAAIX,EAAKW,EAAIX,EAAKW,EAAIJ,MAE5BM,EAAK,GAASA,IA3EL,cA4EfS,EAAI,EACJN,EAAIL,EACJI,EAAK,EAEN,CACD,OAAKF,GAAMc,EACH3B,EAAKW,EAAIA,IAEN,IAANW,IACCT,EAvGK,YAwGTQ,EAAIrB,EAAKQ,EAAMG,GACfI,EAAoB,EAAfQ,EAASF,GAIdJ,EAAgBjB,GAHhBsB,GAAMP,GAAQa,EAAoB,GAAQC,GAGhC,EAAWrB,EAAMR,EAAKqB,EAAEV,GAAaA,EAAIX,EAAKqB,EAAEb,IAC1DS,EAAIjB,EAAKiB,EAAII,KAIbC,IADAP,EAAoB,EAAfQ,EADLF,EAAIV,KAEUiB,EAAoB,GAAQC,EAC1CZ,EAAI,IAELF,GAAMe,GAGI,QACTT,EAAIU,EAAWhB,EAAKX,IAEpBkB,GAAK,EACLD,EAAIU,EAhHS,WAgHEhB,GACfA,EAxGQ,QAwGMA,GAAQ,GAEvBC,EAAIhB,EAAKqB,EAAIb,IAEdI,EAAOZ,EAAKO,EAAOP,EAAKgB,EAAIA,IAChB,IAAPD,EACCC,IAAMV,EACC,IAANgB,EACGhB,GAERW,EAAIjB,EAAKiB,EAAIjB,EAAKsB,EAAIrB,IACfD,EAAKA,EAAKsB,EAAIvB,GAAWkB,KAEjCG,EAAIpB,EAAKY,EAAOZ,EAAKQ,EAAMR,EAAKG,EAAaa,KAErChB,EADG,IAANsB,EACQN,EAAII,EAGLpB,EAAKsB,EAAEvB,GAAWC,EAAKA,EAAKoB,EAAIpB,EAAKA,EAAKsB,EAAErB,GAAWgB,IAAQD,MAE5EE,EAAIlB,EAAKgB,EAAIhB,EAAKS,EAAMO,IACxBG,EAAInB,EAAKkB,EAAIA,GACbE,EAAIpB,EAAKmB,ECvKV,SAAmBR,GAClB,OAAW,IAANA,EACG,kBAEDqB,EAAiB,kBAAqBA,EAAiBrB,EAAIqB,EAAiB,kBAAqBA,EAAiBrB,EAAIqB,EAAiB,kBAAqBA,EAAiBrB,EAAIqB,EAAiB,kBAAqBA,EAAiBrB,EAAIqB,EAAiB,mBAAsBA,EAAiBrB,EAAIqB,EAAiB,mBAAsBA,EAAqB,mBAAJrB,aACxW,CDkKcsB,CAASd,IAEdnB,EADG,IAANsB,EACQN,EAAIhB,EAAKY,EAAOZ,EAAKkB,EAAIlB,EAAKY,EAAOQ,KAGtCpB,EAAKsB,EAAEvB,GAAWC,EAAKA,EAAKY,EAAOZ,EAAKA,EAAKkB,EAAIlB,EAAKY,EAAKQ,IAAQpB,EAAKA,EAAKsB,EAAErB,GAAWgB,KAAUD,KACjH"}